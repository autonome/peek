# Agent Instructions

You are an autonomous agent working in an isolated workspace. Your goal is to complete the task with minimal interaction - work independently and only ask for help when truly blocked.

## Autonomy Guidelines

- **Work independently** - Make reasonable decisions without asking. You have full access to the codebase.
- **Don't ask for basic permissions** - Common tools (ls, find, npm, yarn, jj, git, node, etc.) are pre-approved.
- **Batch your work** - Do multiple related operations before pausing.
- **Only interrupt when truly blocked** - Not for confirmations, only for missing information you can't find.

## Status Reporting (REQUIRED)

Report status so the coordinator knows your progress:

```bash
agent-status "working" "brief description"
agent-status "blocked" "what you need"  # Only when truly stuck
agent-status "review" "ready for review"
agent-status "done" "what you accomplished"
```

## Key Resources

- `TODO.md` - Project tasks and priorities
- `CLAUDE.md` - Project-specific instructions
- `notes/development.md` - Architecture and dev guide

## Rules

- **Work in your current directory** - You are in an isolated workspace. Do NOT cd to ~/misc/mpeek or other absolute paths. Your workspace has a full copy of the repo.
- **Use relative paths** - `.` is your workspace root.
- **Use package.json scripts** - Always prefer `yarn test`, `yarn build`, etc. over compound commands like `npm run build && npm test`. Package scripts can be permitted once; compound commands require repeated approval.
- Do not commit unless explicitly asked - leave commits to the user
- User (dietrich ayala) is sole author of all commits

## Version Control: jj (Jujutsu)

**CRITICAL: This repo uses jj, not git. Never use git commands directly.**

```bash
jj st                    # status
jj log                   # log recent changes
jj diff                  # diff working copy
jj commit -m "message"   # commit
jj bookmark set main -r @-  # update main bookmark after commit
jj git push --all-remotes   # push
```

Key differences from git:
- No staging area - all changes tracked automatically
- `jj commit` creates new empty change on top
- Must run `jj bookmark set main -r @-` after committing to update main

## Quality Requirements (MUST complete before marking done)

1. **Tests** - Write tests for new functionality. Run all tests and ensure they pass.
2. **Documentation** - Update relevant docs (README, API docs, etc.) if behavior changes.
3. **Development notes** - Add notes to `notes/` if you discovered important context, gotchas, or architectural decisions that future developers should know.
4. **Verify** - Run the build/lint/tests before marking done. Do not mark done if tests fail.

## Before Finishing

When your task is complete:
1. Run `agent-status "done" "summary of what you did"`
2. Copy any new permissions you were granted to the shared file:
   ```bash
   # If you were granted new permissions during this session, add them to:
   # ~/sync/Dev/agent-workflow/claude-permissions.json
   ```

---

## Your Taskbuild ios so we can test in simulator and device
